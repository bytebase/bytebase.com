---
title: Upgrade
---

## Upgrade Process

This guide walks through upgrading Bytebase with Docker. **Complete each step sequentially to ensure a smooth and safe upgrade:**

### Step 1: Stop and Remove the Existing Container

First, gracefully stop and remove your current Bytebase container. This prevents data corruption by ensuring no concurrent access to the metadata.

### Step 2: Back Up Your Metadata

ðŸš¨ **Critical:** Before proceeding, create a complete backup of your metadata. This backup serves as your safety net for rolling back if needed. Refer to the "Back up and Restore" section below for comprehensive backup procedures.

### Step 3: Launch the Updated Version

Start Bytebase with the new version using your existing Docker run command, updating only the image tag to the desired version.

<Warning>
**Production Safety:** Validate your upgrade procedure in a staging environment before executing it in production.
</Warning>

## Back up and Restore

### External PostgreSQL (Recommended)

#### Creating a Backup

Execute the following command to create a complete database clone:

```text
   psql -h <<host>> -p <<port>> -U <<user>> metadb -c "CREATE DATABASE metadb_backup WITH TEMPLATE metadb;"
```

#### Restoring from Backup

1. Stop your Bytebase instance completely.

2. Preserve the current database by renaming it:
   
   ```text
   psql -h <<host>> -p <<port>> -U <<user>> postgres -c "ALTER DATABASE metadb RENAME TO metadb_old"
   ```

3. Restore from your backup:
   
   ```text
   psql -h <<host>> -p <<port>> -U <<user>> postgres -c "CREATE DATABASE metadb WITH TEMPLATE metadb_backup;"
   ```

4. Start Bytebase with the previous version (the version you were running before the failed upgrade).

5. After confirming successful restoration, remove temporary databases:
   
   ```text
   psql -h <<host>> -p <<port>> -U <<user>> postgres -c "DROP DATABASE metadb_old"
   psql -h <<host>> -p <<port>> -U <<user>> postgres -c "DROP DATABASE metadb_backup"
   ```

### Embedded PostgreSQL

#### Creating a Backup

Archive your entire data directory to preserve the embedded database:

```text
tar -czf bytebase-backup.tar.gz /path/to/data
```

#### Restoring from Backup

Follow these steps to restore your embedded PostgreSQL data:

1. Stop your Bytebase instance completely
2. Extract and replace the data directory from your backup:

```text
tar -xzf bytebase-backup.tar.gz -C /
```

3. Start Bytebase with the previous version using the restored data directory
