---
title: Configure External PostgreSQL
---

import TerminalDockerRunPgUrl from '/snippets/install/terminal-docker-run-pg-url.mdx';

## PostgreSQL Setup

PostgreSQL 14 or above.

### Database

Create a database named `bytebase` with UTF-8 encoding. UTF-8 encoding is required for proper system operation.

### User

Create a user `bytebase` with one of the following privilege levels:

#### Option 1: Superuser
<Note>
This option is not available on managed database services like AWS RDS or Google Cloud SQL.
</Note>

Grant PostgreSQL superuser privileges:
```sql
ALTER ROLE bytebase SUPERUSER;
```

#### Option 2: Database Owner
Make the user own the database:
```sql
ALTER DATABASE bytebase OWNER TO bytebase;
```

#### Option 3: Schema Create Privilege
Grant CREATE privilege on the public schema:
```sql
GRANT CREATE ON SCHEMA public TO bytebase;
```

### PG_URL String Format

Bytebase uses the standard PostgreSQL connection URI format. See the [official PostgreSQL documentation](https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNSTRING-URIS) for complete details.

**Example:**

_postgresql://bytebase:your_password@example.com/bytebase_

## Running with Docker

This bash script demonstrates how to add an external PostgreSQL database as the metadata store when running the bytebase container.

<TerminalDockerRunPgUrl />

## Running with Kubernetes

### Using Connection String in YAML

You can specify the PostgreSQL connection string directly in your Kubernetes YAML file:

```yaml
env:
  - name: PG_URL
    value: 'postgresql://<<user>>:<<secret>>@<<host>>:<<port>>/<<dbname>>'
```

### Using Kubernetes Secrets

Instead of specifying PostgreSQL connection string directly in Helm or Kubernetes yaml file, you can use Kubernetes secrets resources:

#### Kubernetes

Use the following yaml section to replace the `spec.templates.spec.containers.env` section:

```yaml
env:
  - name: PG_URL
    valueFrom:
      secretKeyRef:
        name: secret_name
        key: secret_key
```

#### Helm

Use `--set bytebase.option.existingPgURLSecret` and `--set bytebase.option.existingPgURLSecretKey` to specify the secret key and secret name instead of `--set "bytebase.option.external-url"={NEW_EXTERNAL_URL}`. See more details in [Bytebase - Artifact Hub](https://artifacthub.io/packages/helm/bytebase/bytebase).

