---
title: Data Rollback
feature_name: 'ROLLBACK_DATA_CHANGES'
---

<Card
  title="Tutorial: Manage Database Change with 1-Click Data Rollback"
  icon="graduation-cap"
  href="/tutorials/data-rollback"
  horizontal
/>

Bytebase allows taking **Prior Backup** before a data change is made. Bytebase stores the pre-snapshot of the affected rows, which allows you to revert that data change if needed.

<Info>

The backup data is stored in your own database instance. Bytebase does not purge the backup data automatically.
You can manually delete the data in `bbdataarchive` database/schema.

</Info>

## Supported Databases

| Database   | Prerequisites                                                                         | Prior Backup | 1-click Rollback |
| ---------- | ------------------------------------------------------------------------------------- | ------------ | ---------------- |
| MySQL      | Create a `bbdataarchive` **database** on the instance where your database is located. | ✅           | ✅               |
| PostgreSQL | Create a `bbdataarchive` **schema** on the database.                                  | ✅           | ✅               |
| Oracle     | Create a `bbdataarchive` **schema** on the database.                                  | ✅           | ✅               |
| SQL Server | Create a `bbdataarchive` **database** on the instance where your database is located. | ✅           | ✅               |

## Supported Operations

We are working on enabling backup and 1-click rollback for more SQL statements.

### Feasibility Conditions

Prior backup is feasible when meeting **all** of the following conditions:

- The SQL statement size is less than 2M.

- No mixed `UPDATE`/`DELETE` on the same table.

- No mixed DDL/DML.

1-click rollback is feasible when meeting **all** of the following conditions:

- For `UPDATE`, the changed table has primary key and primary key columns are not updated.

## Create backup

You can toggle **Prior Backup** switch before or after creating the issue.

   ![bb-issue-backup-on](/content/docs/change-database/rollback-data-changes/bb-issue-backup-on.webp)

<Note>If the switch is disabled, go to the database page and click **Sync instance** first.</Note>

## 1-click rollback

1. Once the change has been rolled out. You can click the **Rollback available** link to create the rollback plan.

   ![bb-issue-done-1](/content/docs/change-database/rollback-data-changes/bb-issue-done-1.webp)

1. There might be more than one rollbackable changes.

   <Note>It might be one change to multiple databases or multiple changes to one database or both.</Note>

   ![bb-issue-done-2](/content/docs/change-database/rollback-data-changes/bb-issue-done-2.webp)

1. You can choose to rollback one or all of them.

   ![bb-rollback-select](/content/docs/change-database/rollback-data-changes/bb-rollback-select.webp)

1. The rollback plan automatically populates the rollback statements.

   ![bb-rollback-issue-1](/content/docs/change-database/rollback-data-changes/bb-rollback-issue-1.webp)

   ![bb-rollback-issue-2](/content/docs/change-database/rollback-data-changes/bb-rollback-issue-2.webp)

## Inspect the backup data

You can go to SQL Editor to inspect the backup data.

   ![bb-sql-editor-test](/content/docs/change-database/rollback-data-changes/bb-sql-editor-test.webp)
   ![bb-sql-editor-prod](/content/docs/change-database/rollback-data-changes/bb-sql-editor-prod.webp)

## Project backup settings

- You can enable **Prior Backup** by default.
- You can control whether you want to skip backup errors and continue changing the data.

   ![prior-backup-default](/content/docs/change-database/rollback-data-changes/bb-prior-backup-default.webp)

## Appendix: Setting Up `bbdataarchive`

### MySQL

1. Create the `bbdataarchive` Database:

   ```sql
   CREATE DATABASE bbdataarchive;
   ```

1. Grant Necessary Privileges:

   Replace `your_user` with the actual username.

   ```sql
   GRANT ALL PRIVILEGES ON bbdataarchive.* TO 'your_user'@'%';
   FLUSH PRIVILEGES;
   ```

### PostgreSQL

1. Create the `bbdataarchive` Schema:

   ```sql
   CREATE SCHEMA bbdataarchive;
   ```

1. Grant Necessary Privileges:

   Replace `your_user` with the actual username.

   ```sql
   GRANT ALL PRIVILEGES ON SCHEMA bbdataarchive TO your_user;
   GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA bbdataarchive TO your_user;
   ```

### Oracle

1. Create the `bbdataarchive` User:

   ```sql
   CREATE USER bbdataarchive IDENTIFIED BY password;
   ```

1. Grant Connection Privileges:

   ```sql
   GRANT CREATE SESSION TO bbdataarchive;
   ```

1. Grant unlimited space quota to the `bbdataarchive` user on the specified `tablespace`:

   Replace `tablespace_name` with the actual tablespace name.

   ```sql
   GRANT QUOTA UNLIMITED ON tablespace_name TO bbdataarchive;
   ```

1. Grant Privileges to the Instance Administrator:

   Replace `admin_user` with the actual username of the instance administrator.

   ```sql
   GRANT CREATE ANY TABLE TO admin_user;
   GRANT SELECT ANY TABLE TO admin_user;
   ```

### SQL Server

1. Create the `bbdataarchive` Database:

   ```sql
   CREATE DATABASE bbdataarchive;
   ```

1. Grant Necessary Privileges:

   Replace `your_user` with the actual username.

   ```sql
   USE bbdataarchive;
   GRANT CONTROL ON DATABASE::bbdataarchive TO your_user;
   ```
