---
title: Data Rollback
feature_name: 'ROLLBACK_DATA_CHANGES'
---

<Card
  title="Tutorial: Manage Database Change with 1-Click Data Rollback"
  icon="graduation-cap"
  href="/tutorials/data-rollback"
  horizontal
/>

Bytebase provides **Prior Backup** functionality that captures a snapshot of data before changes are applied. This safety mechanism stores the original state of affected rows, enabling you to revert data changes with **1-Click** when necessary. You can perform **multi-task rollbacks** to efficiently revert multiple related changes across databases in one operation.

<Info>

Backup data is stored within your own database instance in a dedicated `bbdataarchive` location. Bytebase does not automatically purge this backup data, so you can manually clean up the `bbdataarchive` database or schema as needed.

</Info>

## Supported Databases

| Database   | Prerequisites                                                                         | Prior Backup | 1-click Rollback |
| ---------- | ------------------------------------------------------------------------------------- | ------------ | ---------------- |
| MySQL      | Create a `bbdataarchive` **database** on the instance where your database is located. | ✅           | ✅               |
| PostgreSQL | Create a `bbdataarchive` **schema** on the database.                                  | ✅           | ✅               |
| Oracle     | Create a `bbdataarchive` **schema** on the database.                                  | ✅           | ✅               |
| SQL Server | Create a `bbdataarchive` **database** on the instance where your database is located. | ✅           | ✅               |

## Supported Operations

Bytebase continues to expand backup and rollback support for additional SQL statement types.

### Feasibility Conditions

Prior backup is feasible when meeting **all** of the following conditions:

- The SQL statement size is less than 2M.
- No mixed `UPDATE`/`DELETE` on the same table.
- No mixed DDL/DML.

1-click rollback is feasible when meeting **all** of the following conditions:

- For `UPDATE`, the changed table has primary key and primary key columns are not updated.

## Enable Prior Backup

You can enable the **Prior Backup** option either before or after creating a database change issue.

   ![bb-issue-backup-on](/content/docs/change-database/rollback-data-changes/bb-issue-backup-on.webp)

<Note>
If the Prior Backup switch appears disabled, navigate to the database page and click **Sync instance** to refresh the database metadata.
</Note>

## Perform 1-Click and Multi-Task Rollback

1. After your database change has been successfully deployed, click the **Rollback available** link to initiate the rollback process.

   ![bb-issue-done-1](/content/docs/change-database/rollback-data-changes/bb-issue-done-1.webp)

1. You may see multiple rollbackable changes available, depending on your deployment scenario.

   <Note>
   This could include a single change applied to multiple databases, multiple changes to one database, or a combination of both scenarios.
   </Note>

   ![bb-issue-done-2](/content/docs/change-database/rollback-data-changes/bb-issue-done-2.webp)

1. Select which changes you want to rollback - you can choose individual changes or rollback all of them at once. This **multi-task rollback** capability allows you to efficiently revert multiple related changes in a single operation.

   ![bb-rollback-select](/content/docs/change-database/rollback-data-changes/bb-rollback-select.webp)

1. Bytebase automatically generates the appropriate rollback SQL statements based on the backup data.

   ![bb-rollback-issue-1](/content/docs/change-database/rollback-data-changes/bb-rollback-issue-1.webp)

   ![bb-rollback-issue-2](/content/docs/change-database/rollback-data-changes/bb-rollback-issue-2.webp)

## Inspect Backup Data

You can examine the stored backup data using Bytebase's SQL Editor to verify what information has been preserved.

   ![bb-sql-editor-test](/content/docs/change-database/rollback-data-changes/bb-sql-editor-test.webp)
   ![bb-sql-editor-prod](/content/docs/change-database/rollback-data-changes/bb-sql-editor-prod.webp)

## Project Backup Settings

Configure backup behavior at the project level for consistent data protection:

- **Default backup**: Enable **Prior Backup** by default for all changes in the project
- **Error handling**: Control whether to skip backup errors and proceed with data changes

   ![prior-backup-default](/content/docs/change-database/rollback-data-changes/bb-prior-backup-default.webp)

## Appendix: Setting Up `bbdataarchive`

Before using Prior Backup functionality, you must create the `bbdataarchive` storage location in your database instance. Follow the instructions for your specific database engine:

### MySQL

1. **Create the backup database:**

   ```sql
   CREATE DATABASE bbdataarchive;
   ```

1. **Grant necessary privileges:**

   Replace `your_user` with the actual username that Bytebase uses to connect to your database.

   ```sql
   GRANT ALL PRIVILEGES ON bbdataarchive.* TO 'your_user'@'%';
   FLUSH PRIVILEGES;
   ```

### PostgreSQL

1. **Create the backup schema:**

   ```sql
   CREATE SCHEMA bbdataarchive;
   ```

1. **Grant necessary privileges:**

   Replace `your_user` with the actual username that Bytebase uses to connect to your database.

   ```sql
   GRANT ALL PRIVILEGES ON SCHEMA bbdataarchive TO your_user;
   GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA bbdataarchive TO your_user;
   ```

### Oracle

1. **Create the backup user:**

   ```sql
   CREATE USER bbdataarchive IDENTIFIED BY password;
   ```

1. **Grant connection privileges:**

   ```sql
   GRANT CREATE SESSION TO bbdataarchive;
   ```

1. **Grant unlimited space quota:**

   Replace `tablespace_name` with your actual tablespace name.

   ```sql
   GRANT QUOTA UNLIMITED ON tablespace_name TO bbdataarchive;
   ```

1. **Grant privileges to the instance administrator:**

   Replace `admin_user` with the actual username that Bytebase uses as the instance administrator.

   ```sql
   GRANT CREATE ANY TABLE TO admin_user;
   GRANT SELECT ANY TABLE TO admin_user;
   ```

### SQL Server

1. **Create the backup database:**

   ```sql
   CREATE DATABASE bbdataarchive;
   ```

1. **Grant necessary privileges:**

   Replace `your_user` with the actual username that Bytebase uses to connect to your database.

   ```sql
   USE bbdataarchive;
   GRANT CONTROL ON DATABASE::bbdataarchive TO your_user;
   ```
