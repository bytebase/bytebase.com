---
title: Manage Databases with Terraform
author: Adela
updated_at: 2025/07/10 21:15
tags: Tutorial
integrations: Terraform
category: 'Integration'
featured: true
level: Intermediate
estimated_time: '20 mins'
---

import TerminalDockerRunVolume from '/snippets/install/terminal-docker-run-volume.mdx';

This tutorial is part of the **Bytebase Terraform Provider** series:

- Part 1: [Manage Environments with Terraform](/tutorials/manage-environments-in-bytebase-with-terraform) - Set up environments with policies
- ðŸ‘‰ Part 2: Manage Databases with Terraform - Register database instances
- Part 3: [Manage Projects with Terraform](/tutorials/manage-projects-in-bytebase-with-terraform) - Organize databases into projects
- Part 4: [Manage Bytebase Settings with Terraform](/tutorials/manage-bytebase-settings-with-terraform) - Configure workspace profile and approval policies
- Part 5: [Manage SQL Review Rules with Terraform](/tutorials/manage-sql-review-rules-with-terraform) - Define SQL review policies
- Part 6: [Manage Users and Groups with Terraform](/tutorials/manage-users-and-groups-with-terraform) - Set up dummy users and groups
- Part 7: [Manage Database Access Control with Terraform](/tutorials/manage-database-access-control-with-terraform) - Define permissions
- Part 8: [Manage Data Masking with Terraform](/tutorials/manage-data-masking-with-terraform) - Protect sensitive data

<Card icon="code-xml" cta="View sample code" href="https://github.com/bytebase/terraform-provider-bytebase/tree/main/tutorials">

This tutorial series uses separate Terraform files for better organization. Files are numbered by tutorial part and sub-step (e.g., `1-1-env-setting.tf`, `1-2-env-policy-rollout.tf` for Part 1, `2-instances.tf` for Part 2, etc.). Terraform automatically handles dependencies between files.

</Card>

## What You'll Learn

Register database instances in Bytebase using Terraform.

## Prerequisites

Before starting this tutorial, ensure you have:

- **Completed [Part 1](/tutorials/manage-environments-in-bytebase-with-terraform)**: Environments configured
- **Bytebase running**: With built-in sample data
- **Service account**: Already created from Part 1
- **Terraform initialized**: From Part 1

## Step 1 - Explore Built-in Instances

Due to the built-in sample data configuration from Part 1, Bytebase comes with two sample PostgreSQL instances. Let's explore them:

1. In Bytebase, click **Instances** on the left sidebar. You'll see two PostgreSQL instances:

   - **Test Sample Instance** (port 8083)
   - **Prod Sample Instance** (port 8084)

2. Click **+Add Instance**, you may add more database instances.

   ![add-instance](/content/docs/tutorials/manage-databases-in-bytebase-with-terraform/bb-add-instance.webp)

3. Click **Projects** on the left sidebar to see the `Sample Project`, then click it. You'll see:

   - `hr_test` database on Test instance
   - `hr_prod` database on Prod instance

4. Click **+ New DB**, you may create more databases on the existing instances.

   ![add-db](/content/docs/tutorials/manage-databases-in-bytebase-with-terraform/bb-add-db.webp)

## Step 2 - Register Instances with Terraform

Now let's import these instances into Terraform management. Create `2-instances.tf` with the following configuration:

```hcl
# Test Sample Instance - PostgreSQL on port 8083
resource "bytebase_instance" "test" {
  depends_on  = [bytebase_setting.environments]
  resource_id = "test-sample-instance"
  environment = "environments/test"
  title       = "Test Sample Instance"
  engine      = "POSTGRES"
  activation  = true

  # Connection settings for the built-in test database
  data_sources {
    id       = "admin-test"
    type     = "ADMIN"
    host     = "/tmp"      # Unix socket for local connection
    port     = "8083"
    username = "bbsample"
    password = ""          # Empty for local auth
  }
}

# Production Sample Instance - PostgreSQL on port 8084
resource "bytebase_instance" "prod" {
  depends_on  = [bytebase_setting.environments]
  resource_id = "prod-sample-instance"
  environment = "environments/prod"
  title       = "Prod Sample Instance"
  engine      = "POSTGRES"
  activation  = true

  data_sources {
    id       = "admin-prod"
    type     = "ADMIN"
    host     = "/tmp"
    port     = "8084"
    username = "bbsample"
    password = ""
  }
}
```

### Understanding the Configuration

- **depends_on**: Ensures environments from Part 1 exist first
- **resource_id**: Must match the existing instance ID
- **environment**: Links instance to Test or Prod environment
- **data_sources**: Connection details for the database

## Step 3 - Apply Configuration

Now apply the configuration:

```bash
terraform plan
terraform apply
```

## Step 4 - Verify Setup

1. Go to **Instances** in Bytebase.
2. Verify both instances show:
   - Correct environment assignment
   - "Y" under License column (if using Enterprise)

You can now modify instance properties through Terraform. For example, to rename an instance:

```hcl
resource "bytebase_instance" "test" {
  # ... other config ...
  title = "Development Database"  # Changed title
}
```

## Summary and Next Steps

You've successfully registered database instances with Terraform! You now have:

- **Test and Prod instances** managed as code
- **Connection settings** configured
- **Infrastructure as Code** for your database instances

Continue with [Part 3: Manage Projects with Terraform](/tutorials/manage-projects-in-bytebase-with-terraform) to organize your databases into projects.

**Resources:**

- [Tutorial files](https://github.com/bytebase/terraform-provider-bytebase/tree/main/tutorials)
- [Advanced examples](https://github.com/bytebase/terraform-provider-bytebase/tree/main/examples)
- [Discord community](https://discord.gg/huyw7gRsyA)