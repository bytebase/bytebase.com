---
title: 'DevOps: Database Change Management with MongoDB and GitHub'
author: Ningjing
published_at: 2023/03/22 11:45
feature_image: /content/docs/tutorials/database-change-management-with-mongodb-and-github/feature-image.webp
tags: Tutorial
integrations: MongoDB, GitHub
level: Intermediate
description: This tutorial will bring your MongoDB data change to the next level by introducing the GitOps workflow, where you commit data change script to the GitHub repository, which will in turn trigger the data change pipeline in Bytebase.
---

A series of articles about DevOps: Database Change Management with MongoDB

- [DevOps: Database Change Management with MongoDB](/docs/tutorials/database-change-management-with-mongodb)
- DevOps: Database Change Management with MongoDB and GitHub (this one)

---

In the last article [DevOps: Database Change Management with MongoDB](/docs/tutorials/database-change-management-with-mongodb), you have tried UI workflow in Bytebase.

This tutorial will bring you to the next level by introducing the GitOps workflow, where you commit the schema change script to the GitHub repository, which will in turn trigger the schema deployment pipeline in Bytebase.

You can use Bytebase free version to finish the tutorial.

## Features included

- GitOps Workflow
- Change History

## Prerequisites

Before you start this tutorial, make sure:

- You have followed our previous UI-based change tutorial [DevOps: Database Change Management with MongoDB](/docs/tutorials/database-change-management-with-mongodb).
- You have a [MongoDB Atlas](https://cloud.mongodb.com) account or a [MongoDB Server](https://www.mongodb.com/try/download/community) instance running.
- You have a [GitHub](https://github.com/) account.
- You have a public GitHub repository, e.g  `mongodb-test-bb-local`.
- You have [Docker](https://www.docker.com/) installed locally.
- You have a [ngrok](http://ngrok.com) account.

## Step 1 - Run Bytebase in Docker and set the External URL generated by ngrok

<IncludeBlock url="/docs/get-started/install/vcs-with-ngrok"></IncludeBlock>

## Step 2 - Find your MongoDB instance in Bytebase

1. Visit Bytebase Console through the browser via your ngrok URL. Log in using your account created from the previous tutorial.
   ![bb-login](/content/docs/tutorials/database-change-management-with-mongodb-and-github/bb-login.webp)

2. If you have followed the last article, you should have a project `TestMongoDB` and a database `dbdemo`.

## Step 3 - Connect Bytebase with GitHub.com

1. Click **Settings** on the top bar, and then click **Workspace** > **GitOps**. Choose **GitHub.com** and click **Next**.
   ![bb-gitops-github-step1](/content/docs/tutorials/database-change-management-with-mongodb-and-github/bb-gitops-github-step1.webp)

2. Follow the instructions within **STEP 2**, and in this tutorial, we will use a personal account instead of an organization account. The configuration is similar.

3. Go to your GitHub account. Click **Settings** on the dropdown menu.
   ![gh-settings-dropdown](/content/docs/tutorials/database-change-management-with-mongodb-and-github/gh-settings-dropdown.webp)

4. Click **Developer Settings** at the bottom of the left side bar. Click **OAuth Apps**, and click **New OAuth App**.
   ![gh-oauth-apps](/content/docs/tutorials/database-change-management-with-mongodb-and-github/gh-oauth-apps.webp)

5. Fill **Application name** and then copy the **Homepage** and **Authorization callback URL** in Bytebase and fill them. Click **Register application**.
   ![gh-register-oauth](/content/docs/tutorials/database-change-management-with-mongodb-and-github/gh-register-oauth.webp)

6. After the OAuth application is created successfully. Click **Generate a new client secret**. Copy **Client ID** and this newly generated client secret and paste them back in Bytebase.
   ![gh-copy-client-id](/content/docs/tutorials/database-change-management-with-mongodb-and-github/gh-copy-client-id.webp)
   ![bb-gitops-github-step2](/content/docs/tutorials/database-change-management-with-mongodb-and-github/bb-gitops-github-step2.webp)
   ![gh-auth](/content/docs/tutorials/database-change-management-with-mongodb-and-github/gh-auth.webp)

7. Click **Next**. You will be redirected to the confirmation page. Click **Confirm and add**, and the Git provider is successfully added.
   ![bb-gitops-github-step3](/content/docs/tutorials/database-change-management-with-mongodb-and-github/bb-gitops-github-step3.webp)

## Step 4 - Enable GitOps workflow with MongoDB

1. Go to project `TestMongoDB`, click **GitOps**, and choose **GitOps Workflow**. Click **Configure GitOps**.
   ![bb-project-gitops-gitops-workflow](/content/docs/tutorials/database-change-management-with-mongodb-and-github/bb-project-gitops-gitops-workflow.webp)

2. Choose `GitHub.com` - the provider you just added. It will display all the repositories you can manipulate. Choose `mongodb-test-bb-local`.
   ![bb-project-gitops-github-repo](/content/docs/tutorials/database-change-management-with-mongodb-and-github/bb-project-gitops-github-repo.webp)

3. Keep the default setting, and click **Finish**.

## Step 5 - Change data for MongoDB by pushing SQL data change files to GitHub

1. In your GitHub repository `mongodb-test-bb-local`, create a folder `bytebase`, then create a subfolder `Test`, and create an sql file following the pattern `{{ENV_ID}}/{{DB_NAME}}##{{VERSION}}##{{TYPE}}##{{DESCRIPTION}}.sql`. It is the default configuration for file path template setting under project GitOps.

   `test/db_demo##202303020000##ddl##create_t2.sql`

   - `test` corresponds to `{{ENV_ID}}`
   - `dbdemo` corresponds to `{{DB_NAME}}`
   - `202303222200` corresponds to `{{VERSION}}`
   - `dml` corresponds to `{{TYPE}}`
   - `insert_bella` corresponds to `{{DESCRIPTION}}`

   Paste the sql script in it.

```sql
db.cdemo.insertOne({
  id: 2,
  name: "Bella"
})

```

![vsc-test-sql](/content/docs/tutorials/database-change-management-with-mongodb-and-github/vsc-test-sql.webp)

2. Commit and push this file.
3. Go to Bytebase, and go into project `TestMongoDB`. You’ll find there is a new `Push Event` and a new `issue 106` created.
   ![bb-project-push](/content/docs/tutorials/database-change-management-with-mongodb-and-github/bb-project-push.webp)

4. Click `issue/106` and go the issue page. Click **Resolve issue**, and the issue will be `Done`. You’ll see
   - The issue is created via GitHub.com
   - The issue is executed without approval because it’s on `Test` environment where manual approval is skipped by default. The Assignee is `Bytebase`, because the execution is automatic, and requires no manual approval.
   - The SQL is exactly the one we have committed to the GitHub repository.
   - The Creator is `A`, because the GitHub user you use to commit the change has the same email address found in the Bytebase member list.

![bb-issue-add-bella-done](/content/docs/tutorials/database-change-management-with-mongodb-and-github/bb-issue-add-bella-done.webp)

## Summary and Next

Now you have tried out GitOps workflow, which will store your MongoDB data in GitHub and trigger the change upon committing the change to the repository, to bring your MongoDB change workflow to the next level of Database DevOps - [Database as Code](/blog/database-as-code).

In real world scenario, you might have separate features and main branches corresponding to your dev and production environment, you can check out [GitOps with Feature Branch Workflow](/docs/how-to/workflow/gitops-feature-branch) to learn the setup. Have a try and look forward to your feedback!
