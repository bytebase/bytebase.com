---
title: The Database CI/CD Best Practice with Azure DevOps
author: Ningjing
updated_at: 2024/09/25 18:15
feature_image: /content/docs/tutorials/database-cicd-best-practice-with-azure-devops/database-cicd-with-azure-devops.webp
tags: Tutorial
integrations: 'Azure DevOps'
level: Intermediate
estimated_time: '30 mins'
description: We already have CI/CD for code delivery, why not the database? Imagine applying and deploying database changes the same way you would application code.
---

_Wanna other VCS providers instead?_ ðŸ‘‰

- [The Database CI/CD Best Practice with GitLab](/docs/tutorials/database-cicd-best-practice-with-gitlab)
- [The Database CI/CD Best Practice with GitHub](/docs/tutorials/database-cicd-best-practice-with-github)
- [The Database CI/CD Best Practice with Bitbucket](/docs/tutorials/database-cicd-best-practice-with-bitbucket)

## The Database CI/CD Workflow

<IncludeBlock url="/docs/share/tutorials/database-workflow"></IncludeBlock>

## Set Up Database CI/CD with Azure DevOps in Bytebase (Free Plan)

Here's a step-by-step tutorial on how to set up this Database CI/CD with Azure DevOps in Bytebase.

## Step 1 - Run Bytebase in Docker and set the External URL generated by ngrok

<IncludeBlock url="/docs/get-started/install/vcs-with-ngrok"></IncludeBlock>

## Step 2 - Add Azure DevOps as a Git provider in Bytebase

1. Visit Bytebase via your ngrok URL. Click **CI/CD** > **GitOps**, choose `Azure DevOps Service`.

   ![bb-gitops-azure](/content/docs/tutorials/database-cicd-best-practice-with-azure-devops/bb-gitops-azure.webp)

1. Follow the **personal access token** link to Azure Devops and click **Personal access token**. Then click **New token**. MAKE SURE THAT `All accessible organization` is selected, then check the following fields and click **Create**.

   - Code (Read)
   - Project and Team (Read)
   - Pull Request Threads (Read and Write)
   - User Profile (Read)

   ![azure-personal-access-token](/content/docs/tutorials/database-cicd-best-practice-with-azure-devops/azure-personal-access-token.webp)

   ![azure-new-token](/content/docs/tutorials/database-cicd-best-practice-with-azure-devops/azure-new-token.webp)

1. Copy the generated token, go back to Bytebase, and paste the token into the field and click **Confirm and add**. The provider is added successfully.

## Step 3 - Configure a GitOps Workflow in Bytebase

1. Go to `Azure DevOps`, create a new project `bb-gitops-2024`.

1. Go to Bytebase, go to the `Sample Project`. Click **Integration >GitOps** on the left and click **Add GitOps connector**. Choose `Azure DevOps` (the git provider you just configured) and `xxx/xxx/bb-gitops-2024` (the repository you just created).

1. Keep the default settings for the remaining fields and click **Finish**. The gitops connector is created successfully.

   ![bb-gitops-azure-configure](/content/docs/tutorials/database-cicd-best-practice-with-azure-devops/bb-gitops-azure-configure.webp)

## Step 4 - Configure SQL Review in Prod

<IncludeBlock url="/docs/share/tutorials/sql-review-not-null"></IncludeBlock>

## Step 5 - Create a Pull Request and Trigger SQL Review CI

1. Go to `bb-gitops-2024` on Azure DevOps. Add a new file `202409251700_create_table_t2024.sql` under `bb-test/bytebase/` which is the directory configured in the previous step. Copy the following SQL script into the file and commit the change via a new branch which will create a Pull Request automatically.

   ```sql
   CREATE TABLE "public"."t2024" (
         "id" integer PRIMARY KEY,
         "name" text
   );
   ```

1. Wait for a while, there is a SQL Review comment added. As we configured in the previous step, `NOT NULL` is a warning level SQL Review rule.

   ![azure-sql-review-warning](/content/docs/tutorials/database-cicd-best-practice-with-azure-devops/azure-sql-review-warning.webp)

1. Edit our sql file as following and commit it on the same branch, and merge the PR.

   ```sql
   CREATE TABLE "public"."t2024" (
         "id" integer NOT NULL PRIMARY KEY,
         "name" text NOT NULL
   );
   ```

1. There will be a new comment saying the PR has triggered a Bytebase rollout.

   ![bitb-merged](/content/docs/tutorials/database-cicd-best-practice-with-bitbucket/bitb-merged.webp)

1. Follow the link to go to Bytebase. There's an issue with two stages, this is because we have two databases in this project, by default, the SQL will be applied to all databases within the project. If you merge the previous version SQL script, the SQL Review task run here will show yellow warning and waiting for rollout. Click **Resolve** to resolve the issue.

   ![bb-issue-rollout](/content/docs/tutorials/database-cicd-best-practice-with-bitbucket/bb-issue-rollout.webp)

1. After the rollout completes, click **View change** to see the diff.

   ![bb-view-change-diff](/content/docs/tutorials/database-cicd-best-practice-with-bitbucket/bb-view-change-diff.webp)

1. You may also go to a specific database page to view all its change history.

   ![bb-db-change-history](/content/docs/tutorials/database-cicd-best-practice-with-bitbucket/bb-db-change-history.webp)

## Advanced Features (Enterprise Plan)

<IncludeBlock url="/docs/share/tutorials/database-workflow-advanced-features"></IncludeBlock>

## Summary

Now with Bytebase, you have a complete Database CI/CD workflow with Azure DevOps. You can apply this workflow to your own project and customize it to fit your needs. If you have any questions, please feel free join and discuss in [Discord](https://discord.gg/huyw7gRsyA).

## Further Readings

- [How to integrate SQL Review into Your GitLab or GitHub CI/CD](/docs/tutorials/how-to-integrate-sql-review-into-gitlab-github-ci/)
- [The Database CI/CD Best Practice with GitLab](/docs/tutorials/database-cicd-best-practice-with-gitlab)
- [The Database CI/CD Best Practice with GitHub](/docs/tutorials/database-cicd-best-practice-with-github)
- [The Database CI/CD Best Practice with Bitbucket](/docs/tutorials/database-cicd-best-practice-with-bitbucket)
- [Database as Code - the Good, the Bad and the Ugly](/blog/database-as-code)
